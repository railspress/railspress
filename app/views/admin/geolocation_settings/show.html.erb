<% content_for :page_title, "Geolocation Settings" %>

<div class="max-w-6xl mx-auto space-y-8" data-controller="geolocation-settings">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-3xl font-bold text-white">Geolocation Settings</h1>
      <p class="text-gray-400 mt-1">Configure IP geolocation services for analytics</p>
      <div class="mt-2 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg">
        <p class="text-amber-300 text-sm">
          üõ°Ô∏è <strong>GDPR Notice:</strong> IP geolocation is disabled by default for privacy. 
          Enable only if you have proper consent mechanisms and legal basis.
        </p>
      </div>
    </div>
    
    <div class="flex items-center space-x-3">
      <button data-action="click->geolocation-settings#testConnection" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
        Test Connection
      </button>
      <button data-action="click->geolocation-settings#testLookup" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
        Test Lookup
      </button>
    </div>
  </div>

  <%= form_with url: admin_geolocation_settings_path, method: :patch, local: true, class: "space-y-8" do |form| %>
    <!-- Provider Selection -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6">Geolocation Provider</h2>
      
      <div class="space-y-4">
        <div>
          <%= form.label :geolocation_provider, "Primary Provider", class: "block text-sm font-medium text-gray-300 mb-3" %>
          <%= form.select :geolocation_provider, 
              options_from_collection_for_select(@pronviders.map { |k, v| [k, v] }, :first, :last, @settings[:geolocation_provider]),
              { include_blank: false },
              { 
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",
                data: { action: "change->geolocation-settings#providerChanged" }
              } %>
          <p class="mt-2 text-sm text-gray-500">Choose your primary geolocation provider</p>
        </div>

        <%= form.label :geolocation_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
          <%= form.check_box :geolocation_enabled, { checked: @settings[:geolocation_enabled] }, 'true', 'false' %>
          <span class="text-gray-300">Enable geolocation services</span>
        <% end %>
        <p class="mt-1 text-sm text-red-400">‚ö†Ô∏è <strong>Warning:</strong> Only enable if you have proper GDPR consent mechanisms in place!</p>
      </div>
    </div>

    <!-- GDPR Privacy Controls -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6 flex items-center gap-2">
        üõ°Ô∏è GDPR Privacy Controls
        <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">REQUIRED</span>
      </h2>
      
      <div class="space-y-6">
        <!-- IP Anonymization -->
        <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4">
          <h3 class="text-lg font-medium text-red-300 mb-3">IP Address Handling</h3>
          
          <div class="space-y-4">
            <%= form.label :geolocation_ip_anonymization, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_ip_anonymization, { checked: @settings[:geolocation_ip_anonymization] }, 'true', 'false' %>
              <span class="text-gray-300">Anonymize IP addresses before geolocation lookup</span>
            <% end %>
            <p class="text-sm text-red-300">üîí <strong>Recommended:</strong> Always anonymize IPs to protect user privacy</p>
            
            <%= form.label :geolocation_store_full_ip, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_store_full_ip, { checked: @settings[:geolocation_store_full_ip] }, 'true', 'false' %>
              <span class="text-gray-300">Store full IP address (NOT GDPR compliant)</span>
            <% end %>
            <p class="text-sm text-red-400">‚ö†Ô∏è <strong>Warning:</strong> Storing full IPs may violate GDPR. Only enable if you have explicit consent.</p>
          </div>
        </div>

        <!-- Data Collection Controls -->
        <div class="bg-blue-500/10 border border-blue-500/20 rounded-lg p-4">
          <h3 class="text-lg font-medium text-blue-300 mb-3">Data Collection Scope</h3>
          
          <div class="space-y-4">
            <%= form.label :geolocation_collect_country, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_collect_country, { checked: @settings[:geolocation_collect_country] }, 'true', 'false' %>
              <span class="text-gray-300">Collect country information</span>
            <% end %>
            
            <%= form.label :geolocation_collect_region, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_collect_region, { checked: @settings[:geolocation_collect_region] }, 'true', 'false' %>
              <span class="text-gray-300">Collect region/state information</span>
            <% end %>
            
            <%= form.label :geolocation_collect_city, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_collect_city, { checked: @settings[:geolocation_collect_city] }, 'true', 'false' %>
              <span class="text-gray-300">Collect city information</span>
            <% end %>
            
            <%= form.label :geolocation_collect_coordinates, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_collect_coordinates, { checked: @settings[:geolocation_collect_coordinates] }, 'true', 'false' %>
              <span class="text-gray-300">Collect latitude/longitude coordinates</span>
            <% end %>
            <p class="text-sm text-amber-300">üìç <strong>Note:</strong> More precise data requires stronger legal justification under GDPR</p>
          </div>
        </div>

        <!-- Consent Requirements -->
        <div class="bg-purple-500/10 border border-purple-500/20 rounded-lg p-4">
          <h3 class="text-lg font-medium text-purple-300 mb-3">Consent Requirements</h3>
          
          <div class="space-y-4">
            <%= form.label :geolocation_require_consent, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_require_consent, { checked: @settings[:geolocation_require_consent] }, 'true', 'false' %>
              <span class="text-gray-300">Require explicit consent for geolocation</span>
            <% end %>
            <p class="text-sm text-purple-300">‚úÖ <strong>GDPR Compliant:</strong> Always require consent for geolocation data</p>
            
            <%= form.label :geolocation_consent_message, class: "block text-sm font-medium text-gray-300 mb-2" do %>
              Consent Message
            <% end %>
            <%= form.text_area :geolocation_consent_message, 
                value: @settings[:geolocation_consent_message],
                placeholder: "We collect your approximate location (country/region) to provide better content. This helps us understand our audience and improve our service.",
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",
                rows: 3 %>
            <p class="text-sm text-gray-500">Custom message shown to users when requesting geolocation consent</p>
          </div>
        </div>

        <!-- Data Retention -->
        <div class="bg-green-500/10 border border-green-500/20 rounded-lg p-4">
          <h3 class="text-lg font-medium text-green-300 mb-3">Data Retention</h3>
          
          <div class="space-y-4">
            <%= form.label :geolocation_data_retention_days, "Retention Period (Days)", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.number_field :geolocation_data_retention_days, 
                value: @settings[:geolocation_data_retention_days],
                min: 1,
                max: 365,
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
            <p class="text-sm text-green-300">üóëÔ∏è <strong>GDPR Compliant:</strong> Automatically delete geolocation data after this period</p>
            
            <%= form.label :geolocation_auto_delete, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_auto_delete, { checked: @settings[:geolocation_auto_delete] }, 'true', 'false' %>
              <span class="text-gray-300">Automatically delete old geolocation data</span>
            <% end %>
          </div>
        </div>

        <!-- Legal Basis -->
        <div class="bg-amber-500/10 border border-amber-500/20 rounded-lg p-4">
          <h3 class="text-lg font-medium text-amber-300 mb-3">Legal Basis for Processing</h3>
          
          <div class="space-y-4">
            <%= form.label :geolocation_legal_basis, "Legal Basis", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.select :geolocation_legal_basis,
                options_for_select([
                  ['Consent', 'consent'],
                  ['Legitimate Interest', 'legitimate_interest'],
                  ['Contract', 'contract'],
                  ['Legal Obligation', 'legal_obligation'],
                  ['Vital Interests', 'vital_interests'],
                  ['Public Task', 'public_task']
                ], @settings[:geolocation_legal_basis]),
                { include_blank: "Select legal basis..." },
                { class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" } %>
            <p class="text-sm text-amber-300">‚öñÔ∏è <strong>Required:</strong> You must have a legal basis for processing geolocation data under GDPR</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Power User Settings -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6 flex items-center gap-2">
        ‚ö° Power User Settings
        <span class="px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full">ADVANCED</span>
      </h2>
      
      <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4 mb-6">
        <p class="text-red-300 text-sm">
          ‚ö†Ô∏è <strong>Warning:</strong> These settings bypass GDPR protections. Only use if you have proper legal basis and consent mechanisms.
        </p>
      </div>
      
      <div class="space-y-4">
        <%= form.label :geolocation_full_power_mode, class: "flex items-center space-x-2 cursor-pointer" do %>
          <%= form.check_box :geolocation_full_power_mode, { checked: @settings[:geolocation_full_power_mode] }, 'true', 'false' %>
          <span class="text-gray-300">Enable full geolocation power (bypasses privacy protections)</span>
        <% end %>
        <p class="text-sm text-red-400">üö® <strong>Danger:</strong> This disables GDPR protections. Only enable if you have explicit consent and legal basis!</p>
        
        <%= form.label :geolocation_debug_mode, class: "flex items-center space-x-2 cursor-pointer" do %>
          <%= form.check_box :geolocation_debug_mode, { checked: @settings[:geolocation_debug_mode] }, 'true', 'false' %>
          <span class="text-gray-300">Enable debug logging (may log sensitive data)</span>
        <% end %>
        
        <%= form.label :geolocation_precision_mode, class: "flex items-center space-x-2 cursor-pointer" do %>
          <%= form.check_box :geolocation_precision_mode, { checked: @settings[:geolocation_precision_mode] }, 'true', 'false' %>
          <span class="text-gray-300">Enable high-precision geolocation (city-level accuracy)</span>
        <% end %>
        <p class="text-sm text-amber-300">üìç <strong>Note:</strong> Higher precision requires stronger legal justification under GDPR</p>
      </div>
      </div>
    </div>

    <!-- MaxMind Configuration -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-semibold text-white">MaxMind GeoLite2 Database</h2>
        <div class="flex items-center space-x-2">
          <button type="button" data-action="click->geolocation-settings#updateCountryDb" class="px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded transition-colors">
            Update Country DB
          </button>
          <button type="button" data-action="click->geolocation-settings#updateCityDb" class="px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded transition-colors">
            Update City DB
          </button>
        </div>
      </div>

      <div class="space-y-4">
        <div>
          <%= form.label :maxmind_license_key, "MaxMind License Key", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.text_field :maxmind_license_key, 
              value: @settings[:maxmind_license_key],
              placeholder: "Enter your MaxMind license key",
              class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
          <p class="mt-1 text-sm text-gray-500">
            Get your free license key from 
            <a href="https://www.maxmind.com/en/geolite2/signup" target="_blank" class="text-indigo-400 hover:text-indigo-300">MaxMind</a>
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <%= form.label :maxmind_auto_update, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :maxmind_auto_update, { checked: @settings[:maxmind_auto_update] }, 'true', 'false' %>
              <span class="text-gray-300">Enable automatic database updates</span>
            <% end %>
          </div>

          <div>
            <%= form.label :maxmind_auto_update_frequency, "Update Frequency", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.select :maxmind_auto_update_frequency,
                options_for_select([
                  ['Daily', 'daily'],
                  ['Weekly', 'weekly'],
                  ['Monthly', 'monthly']
                ], @settings[:maxmind_auto_update_frequency]),
                {},
                { class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" } %>
          </div>
        </div>
      </div>

      <!-- Database Status -->
      <div class="mt-6 p-4 bg-[#0a0a0a] rounded-lg">
        <h3 class="text-lg font-medium text-white mb-4">Database Status</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <% @database_info.each do |type, info| %>
            <div class="flex items-center justify-between p-3 bg-[#111111] rounded">
              <div>
                <p class="text-white font-medium"><%= type.capitalize %> Database</p>
                <% if info[:exists] %>
                  <p class="text-sm text-gray-400">
                    Size: <%= number_to_human_size(info[:size]) %> | 
                    Age: <%= info[:age_days] %> days
                  </p>
                  <p class="text-xs <%= info[:needs_update] ? 'text-red-400' : 'text-green-400' %>">
                    <%= info[:needs_update] ? 'Needs update' : 'Up to date' %>
                  </p>
                <% else %>
                  <p class="text-sm text-red-400">Not downloaded</p>
                <% end %>
              </div>
              <div class="text-right">
                <% if info[:exists] %>
                  <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    Available
                  </span>
                <% else %>
                  <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                    Missing
                  </span>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- External API Services -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6">External API Services</h2>
      
      <div class="space-y-6">
        <!-- IP-API.com -->
        <div class="border border-[#2a2a2a] rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-medium text-white">IP-API.com</h3>
            <%= form.label :geolocation_ipapi_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_ipapi_enabled, { checked: @settings[:geolocation_ipapi_enabled] }, 'true', 'false' %>
              <span class="text-gray-300">Enable</span>
            <% end %>
          </div>
          <p class="text-sm text-gray-400 mb-3">Free service with rate limits. No API key required.</p>
        </div>

        <!-- IPInfo.io -->
        <div class="border border-[#2a2a2a] rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-medium text-white">IPInfo.io</h3>
            <%= form.label :geolocation_ipinfo_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_ipinfo_enabled, { checked: @settings[:geolocation_ipinfo_enabled] }, 'true', 'false' %>
              <span class="text-gray-300">Enable</span>
            <% end %>
          </div>
          <div>
            <%= form.label :geolocation_ipinfo_api_key, "API Key", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :geolocation_ipinfo_api_key,
                value: @settings[:geolocation_ipinfo_api_key],
                placeholder: "Enter your IPInfo.io API key",
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
          </div>
          <p class="mt-1 text-sm text-gray-500">
            Get your API key from 
            <a href="https://ipinfo.io/signup" target="_blank" class="text-indigo-400 hover:text-indigo-300">IPInfo.io</a>
          </p>
        </div>

        <!-- IP Geolocation API -->
        <div class="border border-[#2a2a2a] rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-medium text-white">IP Geolocation API</h3>
            <%= form.label :geolocation_ipgeolocation_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_ipgeolocation_enabled, { checked: @settings[:geolocation_ipgeolocation_enabled] }, 'true', 'false' %>
              <span class="text-gray-300">Enable</span>
            <% end %>
          </div>
          <div>
            <%= form.label :geolocation_ipgeolocation_api_key, "API Key", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :geolocation_ipgeolocation_api_key,
                value: @settings[:geolocation_ipgeolocation_api_key],
                placeholder: "Enter your IP Geolocation API key",
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
          </div>
          <p class="mt-1 text-sm text-gray-500">
            Get your API key from 
            <a href="https://ipgeolocation.io/pricing.html" target="_blank" class="text-indigo-400 hover:text-indigo-300">IP Geolocation</a>
          </p>
        </div>

        <!-- Abstract API -->
        <div class="border border-[#2a2a2a] rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-medium text-white">Abstract API</h3>
            <%= form.label :geolocation_abstract_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
              <%= form.check_box :geolocation_abstract_enabled, { checked: @settings[:geolocation_abstract_enabled] }, 'true', 'false' %>
              <span class="text-gray-300">Enable</span>
            <% end %>
          </div>
          <div>
            <%= form.label :geolocation_abstract_api_key, "API Key", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :geolocation_abstract_api_key,
                value: @settings[:geolocation_abstract_api_key],
                placeholder: "Enter your Abstract API key",
                class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
          </div>
          <p class="mt-1 text-sm text-gray-500">
            Get your API key from 
            <a href="https://app.abstractapi.com/api/ip-geolocation" target="_blank" class="text-indigo-400 hover:text-indigo-300">Abstract API</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Privacy & Performance Settings -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6">Privacy & Performance</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-4">
          <%= form.label :geolocation_anonymize_ip, class: "flex items-center space-x-2 cursor-pointer" do %>
            <%= form.check_box :geolocation_anonymize_ip, { checked: @settings[:geolocation_anonymize_ip] }, 'true', 'false' %>
            <span class="text-gray-300">Anonymize IP addresses (GDPR compliant)</span>
          <% end %>

          <%= form.label :geolocation_store_full_ip, class: "flex items-center space-x-2 cursor-pointer" do %>
            <%= form.check_box :geolocation_store_full_ip, { checked: @settings[:geolocation_store_full_ip] }, 'true', 'false' %>
            <span class="text-gray-300">Store full IP addresses (not recommended)</span>
          <% end %>

          <%= form.label :geolocation_fallback_enabled, class: "flex items-center space-x-2 cursor-pointer" do %>
            <%= form.check_box :geolocation_fallback_enabled, { checked: @settings[:geolocation_fallback_enabled] }, 'true', 'false' %>
            <span class="text-gray-300">Enable fallback to other providers</span>
          <% end %>
        </div>

        <div>
          <%= form.label :geolocation_cache_duration, "Cache Duration (hours)", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.number_field :geolocation_cache_duration,
              value: @settings[:geolocation_cache_duration],
              min: 1, max: 168, step: 1,
              class: "w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
          <p class="mt-1 text-sm text-gray-500">How long to cache geolocation results</p>
        </div>
      </div>
    </div>

    <!-- Test Section -->
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
      <h2 class="text-xl font-semibold text-white mb-6">Test Configuration</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-2">Test IP Address</label>
          <input type="text" 
                 data-geolocation-settings-target="testIp"
                 value="8.8.8.8"
                 placeholder="Enter IP address to test"
                 class="w-full px-4 py-2 bg-[#0a0a0a] border border-[#2a2a2a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
        </div>
        
        <div class="flex items-end">
          <button type="button" 
                  data-action="click->geolocation-settings#testLookup"
                  class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
            Test Lookup
          </button>
        </div>
      </div>
      
      <div data-geolocation-settings-target="testResult" class="mt-4 hidden">
        <div class="p-4 bg-[#0a0a0a] rounded-lg">
          <h4 class="text-white font-medium mb-2">Test Result</h4>
          <pre data-geolocation-settings-target="testResultContent" class="text-sm text-gray-300 whitespace-pre-wrap"></pre>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="flex items-center justify-between">
      <div>
        <%= form.check_box :update_databases, { class: "mr-2" } %>
        <%= form.label :update_databases, "Update MaxMind databases now", class: "text-gray-300" %>
      </div>
      
      <%= form.submit "Save Settings", class: "px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors" %>
    </div>
  <% end %>
</div>

<!-- Test IP Modal -->
<div data-geolocation-settings-target="testModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6 max-w-md w-full">
      <h3 class="text-lg font-semibold text-white mb-4">Test Geolocation Lookup</h3>
      <div data-geolocation-settings-target="modalContent" class="text-gray-300">
        <!-- Test results will be displayed here -->
      </div>
      <div class="mt-6 flex justify-end">
        <button data-action="click->geolocation-settings#closeModal" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
