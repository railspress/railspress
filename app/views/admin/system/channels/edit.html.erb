<% content_for :page_title, "Edit Channel" %>
<% content_for :stylesheets do %>
<% end %>

<div class="max-w-4xl mx-auto">
  <!-- Header -->
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="text-2xl font-bold text-white mb-2">Edit Channel</h1>
      <p class="text-gray-400">Update channel settings and configuration</p>
    </div>
    <div class="flex items-center gap-3">
      <%= link_to admin_system_channel_path(@channel), class: "flex items-center gap-2 px-4 py-2 border border-[#2a2a2a] hover:border-indigo-500 text-gray-300 hover:text-white rounded-lg transition" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
        </svg>
        View Channel
      <% end %>
      <%= link_to admin_system_channels_path, class: "flex items-center gap-2 px-4 py-2 border border-[#2a2a2a] hover:border-indigo-500 text-gray-300 hover:text-white rounded-lg transition" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Back to Channels
      <% end %>
    </div>
  </div>

  <!-- Form -->
  <div class="bg-[#111111] border border-[#2a2a2a] rounded-xl p-6">
    <%= form_with model: [:admin, :system, @channel], local: true, class: "space-y-6" do |form| %>
      <% if @channel.errors.any? %>
        <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4">
          <div class="flex items-center gap-2 mb-2">
            <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <h3 class="text-red-400 font-medium">Please fix the following errors:</h3>
          </div>
          <ul class="text-red-300 text-sm space-y-1">
            <% @channel.errors.full_messages.each do |message| %>
              <li>â€¢ <%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Basic Information -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-white mb-4">Basic Information</h3>
          
          <div>
            <%= form.label :name, class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :name, 
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",
                placeholder: "e.g., Web, Mobile, Newsletter" %>
            <p class="text-xs text-gray-500 mt-1">The display name for this channel</p>
          </div>

          <div>
            <%= form.label :slug, class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :slug, 
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",
                placeholder: "e.g., web, mobile, newsletter" %>
            <p class="text-xs text-gray-500 mt-1">URL-friendly identifier</p>
          </div>

          <div>
            <%= form.label :domain, class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_field :domain, 
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",
                placeholder: "e.g., www.example.com, m.example.com" %>
            <p class="text-xs text-gray-500 mt-1">Optional domain for this channel</p>
          </div>

          <div>
            <%= form.label :locale, class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.select :locale, 
                options_for_select([
                  ['English (en)', 'en'],
                  ['Spanish (es)', 'es'],
                  ['French (fr)', 'fr'],
                  ['German (de)', 'de'],
                  ['Italian (it)', 'it'],
                  ['Portuguese (pt)', 'pt'],
                  ['Russian (ru)', 'ru'],
                  ['Chinese (zh)', 'zh'],
                  ['Japanese (ja)', 'ja'],
                  ['Korean (ko)', 'ko']
                ], @channel.locale),
                {},
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
            <p class="text-xs text-gray-500 mt-1">Primary language for this channel</p>
          </div>
        </div>

        <!-- Advanced Settings -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-white mb-4">Advanced Settings</h3>
          
          <div>
            <%= form.label :metadata, "Metadata (JSON)", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_area :metadata, 
                value: @channel.metadata.present? ? JSON.pretty_generate(@channel.metadata) : '{}',
                rows: 8,
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono text-sm" %>
            <p class="text-xs text-gray-500 mt-1">Custom metadata for this channel (must be valid JSON)</p>
          </div>

          <div>
            <%= form.label :settings, "Settings (JSON)", class: "block text-sm font-medium text-gray-300 mb-2" %>
            <%= form.text_area :settings, 
                value: @channel.settings.present? ? JSON.pretty_generate(@channel.settings) : '{}',
                rows: 8,
                class: "w-full px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono text-sm" %>
            <p class="text-xs text-gray-500 mt-1">Channel-specific settings (must be valid JSON)</p>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex items-center justify-end gap-3 pt-6 border-t border-[#2a2a2a]">
        <%= link_to admin_system_channel_path(@channel), class: "px-4 py-2 border border-[#2a2a2a] hover:border-gray-500 text-gray-300 hover:text-white rounded-lg transition" do %>
          Cancel
        <% end %>
        <%= form.submit "Update Channel", 
            class: "px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition font-medium" %>
      </div>
    <% end %>
  </div>
</div>

