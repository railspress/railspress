<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Header -->
  <div class="mb-8">
    <%= link_to admin_api_docs_path, class: "inline-flex items-center text-sm text-gray-400 hover:text-white mb-4" do %>
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      Back to API Docs
    <% end %>
    <h1 class="text-3xl font-bold text-white mb-2">REST API Documentation</h1>
    <p class="text-gray-400">Complete reference for all REST API endpoints</p>
  </div>

  <!-- Base Info -->
  <div class="bg-[#1a1a1a] border border-[#2a2a2a] rounded-xl p-6 mb-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <p class="text-sm text-gray-400 mb-2">Base URL</p>
        <div class="bg-[#0d0d0d] rounded-lg p-3 font-mono text-sm">
          <code class="text-blue-400"><%= request.protocol %><%= request.host_with_port %>/api/v1</code>
        </div>
      </div>
      <div>
        <p class="text-sm text-gray-400 mb-2">Content Type</p>
        <div class="bg-[#0d0d0d] rounded-lg p-3 font-mono text-sm">
          <code class="text-green-400">application/json</code>
        </div>
      </div>
    </div>
  </div>

  <!-- Endpoints by Category -->
  <% @endpoints.each_with_index do |(key, category), index| %>
    <div class="bg-[#1a1a1a] border border-[#2a2a2a] rounded-xl p-6 mb-6" id="<%= key %>">
      <!-- Category Header -->
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-white mb-2"><%= category[:title] %></h2>
        <p class="text-gray-400"><%= category[:description] %></p>
      </div>

      <!-- Endpoints -->
      <div class="space-y-6">
        <% category[:endpoints].each_with_index do |endpoint, idx| %>
          <div class="border-t border-[#2a2a2a] pt-6 first:border-t-0 first:pt-0">
            <!-- Endpoint Header -->
            <div class="flex items-start justify-between mb-4">
              <div class="flex items-center space-x-3">
                <span class="inline-flex px-3 py-1 rounded text-xs font-semibold <%= 
                  case endpoint[:method]
                  when 'GET' then 'bg-blue-500/10 text-blue-400 border border-blue-500/20'
                  when 'POST' then 'bg-green-500/10 text-green-400 border border-green-500/20'
                  when 'PUT', 'PATCH' then 'bg-yellow-500/10 text-yellow-400 border border-yellow-500/20'
                  when 'DELETE' then 'bg-red-500/10 text-red-400 border border-red-500/20'
                  end
                %>">
                  <%= endpoint[:method] %>
                </span>
                <code class="text-gray-300 font-mono text-sm"><%= endpoint[:path] %></code>
              </div>
              <% if endpoint[:requires_auth] %>
                <span class="inline-flex items-center px-2 py-1 rounded text-xs bg-purple-500/10 text-purple-400 border border-purple-500/20">
                  <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                  </svg>
                  Auth Required
                </span>
              <% end %>
            </div>

            <!-- Description -->
            <p class="text-gray-300 mb-4"><%= endpoint[:description] %></p>

            <!-- Headers -->
            <% if endpoint[:headers].present? %>
              <div class="mb-4">
                <p class="text-sm font-medium text-gray-400 mb-2">Headers</p>
                <div class="bg-[#0d0d0d] rounded-lg p-4 font-mono text-sm">
                  <% endpoint[:headers].each do |key, value| %>
                    <div class="mb-1"><span class="text-yellow-400"><%= key %>:</span> <span class="text-white"><%= value %></span></div>
                  <% end %>
                </div>
              </div>
            <% end %>

            <!-- Parameters -->
            <% if endpoint[:params].present? %>
              <div class="mb-4">
                <p class="text-sm font-medium text-gray-400 mb-2">Parameters</p>
                <div class="bg-[#0d0d0d] rounded-lg overflow-hidden">
                  <table class="w-full text-sm">
                    <thead class="bg-[#1a1a1a]">
                      <tr>
                        <th class="text-left px-4 py-2 text-gray-400 font-medium">Name</th>
                        <th class="text-left px-4 py-2 text-gray-400 font-medium">Type</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% endpoint[:params].each do |param, type| %>
                        <tr class="border-t border-[#2a2a2a]">
                          <td class="px-4 py-2 font-mono text-blue-400"><%= param %></td>
                          <td class="px-4 py-2 text-gray-300"><%= type %></td>
                        </tr>
                      <% end %>
                    </tbody>
                  </table>
                </div>
              </div>
            <% end %>

            <!-- Response -->
            <% if endpoint[:response].present? %>
              <div>
                <p class="text-sm font-medium text-gray-400 mb-2">Response</p>
                <div class="bg-[#0d0d0d] rounded-lg p-4 font-mono text-sm overflow-x-auto">
                  <pre class="text-gray-300"><%= JSON.pretty_generate(endpoint[:response]) %></pre>
                </div>
              </div>
            <% end %>

            <!-- Example cURL -->
            <details class="mt-4">
              <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">
                Show cURL example
              </summary>
              <div class="mt-2 bg-[#0d0d0d] rounded-lg p-4 font-mono text-xs overflow-x-auto">
                <code class="text-green-400">curl -X <%= endpoint[:method] %> \<br>
  <%= request.protocol %><%= request.host_with_port %><%= endpoint[:path] %> \<br>
  -H "Content-Type: application/json" \<br>
  <% if endpoint[:requires_auth] %>-H "Authorization: Bearer YOUR_TOKEN" \<br><% end %>
  <% if endpoint[:params].present? && ['POST', 'PUT', 'PATCH'].include?(endpoint[:method]) %>-d '<%= JSON.generate(endpoint[:params].keys.map { |k| [k, "value"] }.to_h) %>'<% end %></code>
              </div>
            </details>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Quick Navigation Sidebar (Sticky) -->
  <div class="fixed right-8 top-24 hidden xl:block w-64">
    <div class="bg-[#1a1a1a] border border-[#2a2a2a] rounded-xl p-4 sticky top-24">
      <h3 class="text-sm font-semibold text-white mb-3">Quick Navigation</h3>
      <ul class="space-y-2 text-sm">
        <% @endpoints.each do |key, category| %>
          <li>
            <a href="#<%= key %>" class="text-gray-400 hover:text-white transition-colors">
              <%= category[:title] %>
            </a>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>

<style>
  /* Smooth scroll */
  html {
    scroll-behavior: smooth;
  }
  
  /* Code block styling */
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
  }
</style>


